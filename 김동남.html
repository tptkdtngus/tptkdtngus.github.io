<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>김동남의 저택 탈출</title>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; }
    .container { padding: 20px; }
    h1 { font-size: 2em; font-family: "Brush Script MT", cursive; }
    .section { display: none; margin-top: 20px; }
    .button { margin: 10px 0; padding: 10px; cursor: pointer; }
    #inventory { position: fixed; bottom: 0; width: 100%; background: #eee; padding: 10px; border-top: 1px solid #ccc; }
    #inventory h3 { margin: 0 0 10px 0; }
    .item { display: inline-block; padding: 5px; background: #ddd; margin-right: 5px; cursor: pointer; }
  </style>
</head>
<body onload="initCharacter()">
  <div class="container">
    <h1>김동남</h1>
    <div id="intro" class="section" style="display:block">
      <p>주인이 없는 저택에 들어온 외부인</p>
      <p>저택의 모든 문이 잠김으로써 나갈 방법을 찾는 중</p>
      <button onclick="showSection('lobby')">계속</button>
    </div>

    <div id="lobby" class="section">
      <h2>저택의 로비</h2>
      <button onclick="showSection('front')">저택의 정문</button>
      <button onclick="showSection('back')">저택의 후문</button>
      <button onclick="showSection('second')">2층 로비</button>
      <button onclick="showSection('basement')">지하실 입구</button>
    </div>

    <div id="front" class="section">
      <h2>저택의 정문</h2>
      <input type="text" id="frontPwd" placeholder="비밀번호 입력" />
      <button onclick="checkPassword('front')">열기</button>
      <button onclick="showSearchOptions()">살펴보기</button>
      <div id="frontSearchOptions" style="margin-top:10px; display:none;">
        <button onclick="searchPlace('열쇠 구멍')">열쇠 구멍</button>
        <button onclick="searchPlace('문 밑')">문 밑</button>
        <button onclick="searchPlace('신발장')">신발장</button>
      </div>
      <button onclick="showSection('lobby')">로비로 돌아가기</button>
    </div>

    <div id="back" class="section">
      <h2>저택의 후문</h2>
      <input type="text" id="backPwd" placeholder="비밀번호 입력" />
      <button onclick="checkPassword('back')">열기</button>
      <button onclick="showSection('lobby')">로비로 돌아가기</button>
    </div>

    <div id="second" class="section">
      <h2>2층 로비</h2>
      <p>2층에는 아무도 없는 듯하다.</p>
      <button onclick="showSection('lobby')">로비로 돌아가기</button>
    </div>

    <div id="basement" class="section">
      <h2>지하실 입구</h2>
      <p>지하실 문은 잠겨 있다.</p>
      <button onclick="showSection('lobby')">로비로 돌아가기</button>
    </div>

    <div id="inventory">
      <h3>아이템창</h3>
      <div id="items"></div>
    </div>
  </div>

  <script>
    function setCookie(name, value, days = 7) {
      const expires = new Date(Date.now() + days * 86400000).toUTCString();
      document.cookie = `${name}=${encodeURIComponent(value)}; expires=${expires}; path=/`;
    }

    function getCookie(name) {
      const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
      return match ? decodeURIComponent(match[2]) : null;
    }

    function initCharacter() {
      updateInventory();
    }

    function showSection(id) {
      document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    function checkPassword(door) {
      const input = document.getElementById(door + 'Pwd').value;
      const correct = door === 'front' ? 'Not_Found' : '수정할거임';
      if (input === correct) {
        window.location.href = 'Goal_In_Congratulation_sk2asfxcnjss9db.html';
      } else {
        alert('비밀번호가 맞지 않습니다.');
      }
    }

    function showSearchOptions() {
      document.getElementById('frontSearchOptions').style.display = 'block';
    }

    function searchPlace(place) {
      if (place === '신발장') {
        let items = JSON.parse(getCookie('dongnam_items') || '[]');
        if (!items.includes('누군가의 쪽지')) {
          items.push('누군가의 쪽지');
          setCookie('dongnam_items', JSON.stringify(items));
          updateInventory();
          alert('아이템 "누군가의 쪽지"를 획득했습니다.');
        } else {
          alert('이미 아이템을 얻었습니다.');
        }
      } else {
        alert(`${place}을(를) 살펴보았지만 아무것도 없었습니다.`);
      }
    }

    function updateInventory() {
      const container = document.getElementById('items');
      container.innerHTML = '';
      const items = JSON.parse(getCookie('dongnam_items') || '[]');
      items.forEach(item => {
        const el = document.createElement('div');
        el.className = 'item';
        el.innerText = item;
        el.onclick = () => {
          if (item === '누군가의 쪽지') {
            showNoteDetail();
          }
        };
        container.appendChild(el);
      });
    }

    function showNoteDetail() {
      alert('다락문의 비밀번호는 4722란다 아가야');
      showSection('lobby');
    }
  </script>
</body>
</html>
